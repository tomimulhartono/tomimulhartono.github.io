<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial | Tomi Mulhartono</title>
<meta name=keywords content="cybersecurity,OpenResty,Web Application Firewall"><meta name=description content="Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!
Creating Your New Application Let&rsquo;s get that new app live and kicking in no time. Here&rsquo;s how to create your first application on OpenResty Edge."><meta name=author content="Tomi Mulhartono"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.4599eadb9eb2ad3d0a8d6827b41a8fda8f2f4af226b63466c09c5fddbc8706b7.css integrity="sha256-RZnq256yrT0KjWgntBqP2o8vSvImtjRmwJxf3byHBrc=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/creating-a-new-app-on-openresty-edge/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial"><meta property="og:description" content="Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!
Creating Your New Application Let&rsquo;s get that new app live and kicking in no time. Here&rsquo;s how to create your first application on OpenResty Edge."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/creating-a-new-app-on-openresty-edge/"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-06T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-06T00:00:00+00:00"><meta property="og:site_name" content="Tomi Mulhartono"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial"><meta name=twitter:description content="Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!
Creating Your New Application Let&rsquo;s get that new app live and kicking in no time. Here&rsquo;s how to create your first application on OpenResty Edge."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial","item":"http://localhost:1313/posts/creating-a-new-app-on-openresty-edge/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial","name":"Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial","description":"Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!\nCreating Your New Application Let\u0026rsquo;s get that new app live and kicking in no time. Here\u0026rsquo;s how to create your first application on OpenResty Edge.","keywords":["cybersecurity","OpenResty","Web Application Firewall"],"articleBody":"Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!\nCreating Your New Application Let’s get that new app live and kicking in no time. Here’s how to create your first application on OpenResty Edge.\nLogin to your OpenResty Edge dashboard Head over to the OpenResty Edge dashboard, and log in using your credentials.\nNavigate to the Applications section Once you’re logged in, take a look at the top menu bar and click on Applications. This is where the magic begins! Once you’re in the applications section, click on the Create New App button to start the process of building your app.\nFill Out the application details You’ll need to provide some information to configure your app. Here’s a quick breakdown of each field you’ll encounter:\nFields What to Enter Domains Enter your domain name here (e.g., tomi-example.co.id). HTTP Port You can leave this blank for now. HTTPS Port Set to 443 for secure traffic. Label Give your app a memorable label, like Create a New Example App. Once you’ve filled everything out, hit Save! Your application is officially created, and you’re one step closer to deploying it live.\nConfiguring Page Rules Next up, let’s make sure everything runs smoothly by configuring Page Rules. This allows you to set conditions and actions for traffic coming to your application.\nCustom Edge Language Rules at the Beginning of This Page Before diving into predefined rules, let’s look at how you can add custom rules using OpenResty’s Edge Language. For example, if you want to block requests from specific IPs and log alerts, you can use the following:\nclient-addr !~~ any (192.168.100.1) =\u003e errlog(level: \"alert\", \"SEC-00- Unauthorized IP!\", foreign-call(module: \"headers-log\", func: \"go\") ~ req-body()), exit(444); This rule does two things:\nBlocks traffic from the IP 192.168.100.1. Logs an alert with the message “Unauthorized IP!”. Feel free to tweak these rules to fit your specific needs. After adding them, hit Save to apply.\nCreate New Rules Let’s move on to setting up some common rules you’ll probably need, starting with redirecting traffic from HTTP to HTTPS.\nRedirect HTTP to HTTPS Redirecting users from HTTP to HTTPS is a great way to improve both security and user experience. Here’s how you can set that up:\nClick on New Rule in the Page Rules section.\nSet the condition to identify when the rule should trigger:\nIn the When section, click Add a new condition. From the Variable dropdown, choose Scheme. In the Operator dropdown, select String =. In the Value dropdown, select http. Add the Action to redirect traffic: Under the Actions section, click Add a new action. From the Action Types dropdown, choose Redirect. Set the following fields: URI: Choose current. URI arguments: Choose current. Scheme: Set this to https. Host: Choose current. Port: Set this to blank value. Status Code: Choose 302 Moved Temporarily. This will ensure all users trying to access your site via HTTP will be securely redirected to HTTPS.\nSet Proxy Header If your application relies on specific headers to proxy traffic correctly, you’ll want to configure that as well. Let’s set up a rule to ensure the correct host header is passed along:\nClick on New Rule in the Page Rules section.\nSet the condition for when this rule should apply:\nIn the When section, click Add a new condition. From the Variable dropdown, choose Host. In the Value field, choose String, then type your domain, e.g., tomi-example.co.id. Set the first action to modify the Host header: Under the Actions section, click Add a new action. From the Action Types dropdown, choose Set proxy header. Set the following fields: Header: Enter Host. Value: Choose String and enter your domain, e.g., tomi-example.co.id. Add a second action to append the X-Forwarded-For header: Under the Actions section, click Add a new action again. From the Action Types dropdown, choose Append proxy header value. Set the following fields: Header: Choose X-Forwarded-For. Value: Choose Built-in Variable and select Client address. Configure the Proxy settings: Scroll down to the Proxy section to On. Select the appropriate Proxy to upstream from the dropdown, e.g., example-backend. For Balancing Policy, choose Round Robin This ensures the correct headers are sent to the backend and helps maintain a smooth user experience.\nAdd Custom Edge Language Rules at the End of This Page To improve site performance, caching static assets like JavaScript and CSS is a great practice. Here’s how you can set up cache rules:\nuri-suffix( rx:s/\\.(?:js|css|xml).{0,3}$/), req-method(\"GET\")=\u003e enable-proxy-cache(key: uri), enforce-proxy-cache(7 [day]), set-resp-header(\"Cache-Control\", \"public, max-age=604800, immutable\"); uri-suffix( rx:s/\\.(?:gif|png|js|css|html|jpg|wof|svg|woff2|ttf|otf|eot|ico).{0,5}$/), req-method(\"GET\")=\u003e enable-proxy-cache(key: uri), enforce-proxy-cache(365 [day]), set-resp-header(\"Cache-Control\", \"public, max-age=3153600, immutable\"); This speeds up load times by storing frequently requested assets for a longer period.\nConfiguring Upstreams Now, let’s make sure your app knows where to send requests by configuring an upstream server (where your app’s backend lives).\nClick on Upstreams from your dashboard menu.\nAdd a New Upstream and fill out the details:\nFields What to Enter Upstream Name Enter a name for your upstream, like example-backend. Protocol Choose HTTPS. Host Enter the domain or IP address of your backend server (e.g., tomi-backend.int). Port Set this to 443. Weight Set it to 1. Enabled Switch this On. After everything is set, click Save! Configuring SSL Setting up SSL is key to securing your users’ data. You’ll need to work with your DevOps team to get your SSL certificates in place, but here’s how you can set things up in the OpenResty Edge dashboard.\nManage SSL Certificates In the SSL menu, you’ll see a table to manage certificates. Here’s what you’ll typically need:\nYour SSL certificate (provided by a Certificate Authority). The private key associated with the certificate. Your domain, pointing to the correct gateway cluster. Make sure all of these details are in order before proceeding.\nCheck Gateway Clusters Lastly, double-check the Gateway Clusters tab. Ensure the IP addresses listed here match the setup for your domain to avoid any connection issues.\nYou’re almost done! Once you’re satisfied with all the configurations, click the Release button. This will push your changes live, and your app will officially be up and running!\nAnd there you have it! Your new application is now up and running, with all the necessary rules and configurations in place. If you have any questions or run into any issues, don’t hesitate to reach out. Here’s to smooth sailing and successful deployments!\nFeel free to revisit this guide anytime you need a refresher or have new tweaks to make. Happy configuring!\n","wordCount":"1116","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2024-09-06T00:00:00Z","dateModified":"2024-09-06T00:00:00Z","author":{"@type":"Person","name":"Tomi Mulhartono"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/creating-a-new-app-on-openresty-edge/"},"publisher":{"@type":"Organization","name":"Tomi Mulhartono","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Getting Started with Your New Application on OpenResty Edge: An Easy-to-Follow Tutorial</h1><div class=post-meta><span title='2024-09-06 00:00:00 +0000 +0000'>September 6, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Tomi Mulhartono</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#creating-your-new-application>Creating Your New Application</a></li><li><a href=#configuring-page-rules>Configuring Page Rules</a><ul><li><a href=#custom-edge-language-rules-at-the-beginning-of-this-page>Custom Edge Language Rules at the Beginning of This Page</a></li><li><a href=#create-new-rules>Create New Rules</a><ul><li><a href=#redirect-http-to-https>Redirect HTTP to HTTPS</a></li><li><a href=#set-proxy-header>Set Proxy Header</a></li></ul></li><li><a href=#add-custom-edge-language-rules-at-the-end-of-this-page>Add Custom Edge Language Rules at the End of This Page</a></li></ul></li><li><a href=#configuring-upstreams>Configuring Upstreams</a></li><li><a href=#configuring-ssl>Configuring SSL</a><ul><li><a href=#manage-ssl-certificates>Manage SSL Certificates</a></li><li><a href=#check-gateway-clusters>Check Gateway Clusters</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>Welcome aboard! If you’re gearing up to launch a new application on OpenResty Edge, you’re in the right place. Whether you’re a seasoned pro or just starting out, I’ll walk you through every step of the way with a dash of fun. Grab your favorite drink, settle in, and let’s dive into this setup adventure!</p><hr><h2 id=creating-your-new-application>Creating Your New Application<a hidden class=anchor aria-hidden=true href=#creating-your-new-application>#</a></h2><p>Let&rsquo;s get that new app live and kicking in no time. Here&rsquo;s how to create your first application on OpenResty Edge.</p><ol><li><strong>Login</strong> to your OpenResty Edge dashboard</li></ol><p>Head over to the OpenResty Edge dashboard, and log in using your credentials.</p><p><img loading=lazy src=/images/openresty-1.jpg alt=Screenshoot></p><ol start=2><li>Navigate to the <strong>Applications</strong> section</li></ol><p>Once you&rsquo;re logged in, take a look at the top menu bar and click on <strong>Applications</strong>. This is where the magic begins! Once you&rsquo;re in the applications section, click on the <strong>Create New App</strong> button to start the process of building your app.</p><p><img loading=lazy src=/images/openresty-2.jpg alt=Screenshoot></p><ol start=3><li>Fill Out the application details</li></ol><p>You&rsquo;ll need to provide some information to configure your app. Here’s a quick breakdown of each field you’ll encounter:</p><table><thead><tr><th>Fields</th><th>What to Enter</th></tr></thead><tbody><tr><td><strong>Domains</strong></td><td>Enter your domain name here (e.g., <code>tomi-example.co.id</code>).</td></tr><tr><td><strong>HTTP Port</strong></td><td>You can leave this blank for now.</td></tr><tr><td><strong>HTTPS Port</strong></td><td>Set to <code>443</code> for secure traffic.</td></tr><tr><td><strong>Label</strong></td><td>Give your app a memorable label, like <code>Create a New Example App</code>.</td></tr></tbody></table><p><img loading=lazy src=/images/openresty-3.jpg alt=Screenshoot></p><p>Once you’ve filled everything out, hit <strong>Save</strong>! Your application is officially created, and you&rsquo;re one step closer to deploying it live.</p><hr><h2 id=configuring-page-rules>Configuring Page Rules<a hidden class=anchor aria-hidden=true href=#configuring-page-rules>#</a></h2><p>Next up, let&rsquo;s make sure everything runs smoothly by configuring <strong>Page Rules</strong>. This allows you to set conditions and actions for traffic coming to your application.</p><h3 id=custom-edge-language-rules-at-the-beginning-of-this-page>Custom Edge Language Rules at the Beginning of This Page<a hidden class=anchor aria-hidden=true href=#custom-edge-language-rules-at-the-beginning-of-this-page>#</a></h3><p>Before diving into predefined rules, let’s look at how you can add custom rules using OpenResty&rsquo;s Edge Language. For example, if you want to block requests from specific IPs and log alerts, you can use the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>client-addr !~~ any <span class=o>(</span>192.168.100.1<span class=o>)</span> <span class=o>=</span>&gt;
</span></span><span class=line><span class=cl>    errlog<span class=o>(</span>level: <span class=s2>&#34;alert&#34;</span>, <span class=s2>&#34;SEC-00- Unauthorized IP!&#34;</span>, foreign-call<span class=o>(</span>module: <span class=s2>&#34;headers-log&#34;</span>, func: <span class=s2>&#34;go&#34;</span><span class=o>)</span> ~ req-body<span class=o>())</span>,
</span></span><span class=line><span class=cl>    exit<span class=o>(</span>444<span class=o>)</span><span class=p>;</span></span></span></code></pre></div><p><img loading=lazy src=/images/openresty-4.jpg alt=Screenshoot></p><p>This rule does two things:</p><ul><li>Blocks traffic from the IP <code>192.168.100.1</code>.</li><li>Logs an alert with the message &ldquo;<strong>Unauthorized IP!</strong>&rdquo;.</li></ul><p>Feel free to tweak these rules to fit your specific needs. After adding them, hit <strong>Save</strong> to apply.</p><h3 id=create-new-rules>Create New Rules<a hidden class=anchor aria-hidden=true href=#create-new-rules>#</a></h3><p>Let’s move on to setting up some common rules you&rsquo;ll probably need, starting with redirecting traffic from HTTP to HTTPS.</p><p><img loading=lazy src=/images/openresty-10.jpg alt=Screenshoot></p><h4 id=redirect-http-to-https>Redirect HTTP to HTTPS<a hidden class=anchor aria-hidden=true href=#redirect-http-to-https>#</a></h4><p>Redirecting users from HTTP to HTTPS is a great way to improve both security and user experience. Here’s how you can set that up:</p><ol><li><p>Click on <strong>New Rule</strong> in the Page Rules section.</p></li><li><p>Set the condition to identify when the rule should trigger:</p></li></ol><ul><li>In the <strong>When</strong> section, click <strong>Add a new condition</strong>.</li><li>From the <strong>Variable</strong> dropdown, choose <strong>Scheme</strong>.</li><li>In the <strong>Operator</strong> dropdown, select <strong>String =</strong>.</li><li>In the <strong>Value</strong> dropdown, select <strong>http</strong>.</li></ul><p><img loading=lazy src=/images/openresty-5.jpg alt=Screenshoot></p><ol start=3><li>Add the Action to redirect traffic:</li></ol><ul><li>Under the <strong>Actions</strong> section, click <strong>Add a new action</strong>.</li><li>From the Action Types dropdown, <strong>choose Redirect</strong>.</li><li>Set the following fields:<ul><li><strong>URI:</strong> Choose <strong>current</strong>.</li><li><strong>URI arguments</strong>: Choose <strong>current</strong>.</li><li><strong>Scheme:</strong> Set this to <strong>https</strong>.</li><li><strong>Host:</strong> Choose <strong>current</strong>.</li><li><strong>Port:</strong> Set this to <strong>blank value</strong>.</li><li><strong>Status Code:</strong> Choose <strong>302 Moved Temporarily</strong>.</li></ul></li></ul><p><img loading=lazy src=/images/openresty-6.jpg alt=Screenshoot></p><p>This will ensure all users trying to access your site via HTTP will be securely redirected to HTTPS.</p><h4 id=set-proxy-header>Set Proxy Header<a hidden class=anchor aria-hidden=true href=#set-proxy-header>#</a></h4><p>If your application relies on specific headers to proxy traffic correctly, you’ll want to configure that as well. Let’s set up a rule to ensure the correct host header is passed along:</p><ol><li><p>Click on <strong>New Rule</strong> in the Page Rules section.</p></li><li><p>Set the condition for when this rule should apply:</p></li></ol><ul><li>In the <strong>When</strong> section, click <strong>Add a new condition</strong>.</li><li>From the <strong>Variable</strong> dropdown, choose <strong>Host</strong>.</li><li>In the <strong>Value</strong> field, choose <strong>String</strong>, then type your domain, e.g., <code>tomi-example.co.id</code>.</li></ul><p><img loading=lazy src=/images/openresty-7.jpg alt=Screenshoot></p><ol start=3><li>Set the first action to modify the <strong>Host</strong> header:</li></ol><ul><li>Under the <strong>Actions</strong> section, click <strong>Add a new action</strong>.</li><li>From the <strong>Action Types</strong> dropdown, choose <strong>Set proxy header</strong>.</li><li>Set the following fields:<ul><li><strong>Header:</strong> Enter <strong>Host</strong>.</li><li><strong>Value:</strong> Choose <strong>String</strong> and enter your domain, e.g., <code>tomi-example.co.id</code>.</li></ul></li></ul><ol start=4><li>Add a second action to append the <strong>X-Forwarded-For</strong> header:</li></ol><ul><li>Under the <strong>Actions</strong> section, click <strong>Add a new action</strong> again.</li><li>From the <strong>Action Types</strong> dropdown, choose <strong>Append proxy header value</strong>.</li><li>Set the following fields:<ul><li><strong>Header:</strong> Choose <strong>X-Forwarded-For</strong>.</li><li><strong>Value:</strong> Choose <strong>Built-in Variable</strong> and select <strong>Client address</strong>.</li></ul></li></ul><p><img loading=lazy src=/images/openresty-8.jpg alt=Screenshoot></p><ol start=5><li>Configure the <strong>Proxy</strong> settings:</li></ol><ul><li>Scroll down to the <strong>Proxy</strong> section to <strong>On</strong>.</li><li>Select the appropriate <strong>Proxy to upstream</strong> from the dropdown, e.g., <code>example-backend</code>.</li><li>For <strong>Balancing Policy</strong>, choose <strong>Round Robin</strong></li></ul><p><img loading=lazy src=/images/openresty-9.jpg alt=Screenshoot></p><p>This ensures the correct headers are sent to the backend and helps maintain a smooth user experience.</p><h3 id=add-custom-edge-language-rules-at-the-end-of-this-page>Add Custom Edge Language Rules at the End of This Page<a hidden class=anchor aria-hidden=true href=#add-custom-edge-language-rules-at-the-end-of-this-page>#</a></h3><p>To improve site performance, caching static assets like JavaScript and CSS is a great practice. Here’s how you can set up cache rules:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uri-suffix<span class=o>(</span>
</span></span><span class=line><span class=cl>rx:s/<span class=se>\.</span><span class=o>(</span>?:js<span class=p>|</span>css<span class=p>|</span>xml<span class=o>)</span>.<span class=o>{</span>0,3<span class=o>}</span>$/<span class=o>)</span>,
</span></span><span class=line><span class=cl>req-method<span class=o>(</span><span class=s2>&#34;GET&#34;</span><span class=o>)=</span>&gt;
</span></span><span class=line><span class=cl>    enable-proxy-cache<span class=o>(</span>key: uri<span class=o>)</span>,
</span></span><span class=line><span class=cl>    enforce-proxy-cache<span class=o>(</span><span class=m>7</span> <span class=o>[</span>day<span class=o>])</span>,
</span></span><span class=line><span class=cl>    set-resp-header<span class=o>(</span><span class=s2>&#34;Cache-Control&#34;</span>, <span class=s2>&#34;public, max-age=604800, immutable&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>uri-suffix<span class=o>(</span>
</span></span><span class=line><span class=cl>rx:s/<span class=se>\.</span><span class=o>(</span>?:gif<span class=p>|</span>png<span class=p>|</span>js<span class=p>|</span>css<span class=p>|</span>html<span class=p>|</span>jpg<span class=p>|</span>wof<span class=p>|</span>svg<span class=p>|</span>woff2<span class=p>|</span>ttf<span class=p>|</span>otf<span class=p>|</span>eot<span class=p>|</span>ico<span class=o>)</span>.<span class=o>{</span>0,5<span class=o>}</span>$/<span class=o>)</span>,
</span></span><span class=line><span class=cl>req-method<span class=o>(</span><span class=s2>&#34;GET&#34;</span><span class=o>)=</span>&gt;
</span></span><span class=line><span class=cl>    enable-proxy-cache<span class=o>(</span>key: uri<span class=o>)</span>,
</span></span><span class=line><span class=cl>    enforce-proxy-cache<span class=o>(</span><span class=m>365</span> <span class=o>[</span>day<span class=o>])</span>,
</span></span><span class=line><span class=cl>    set-resp-header<span class=o>(</span><span class=s2>&#34;Cache-Control&#34;</span>, <span class=s2>&#34;public, max-age=3153600, immutable&#34;</span><span class=o>)</span><span class=p>;</span></span></span></code></pre></div><p><img loading=lazy src=/images/openresty-11.jpg alt=Screenshoot></p><p>This speeds up load times by storing frequently requested assets for a longer period.</p><hr><h2 id=configuring-upstreams>Configuring Upstreams<a hidden class=anchor aria-hidden=true href=#configuring-upstreams>#</a></h2><p>Now, let’s make sure your app knows where to send requests by configuring an upstream server (where your app&rsquo;s backend lives).</p><ol><li><p>Click on <strong>Upstreams</strong> from your dashboard menu.</p></li><li><p>Add a <strong>New Upstream</strong> and fill out the details:</p></li></ol><table><thead><tr><th>Fields</th><th>What to Enter</th></tr></thead><tbody><tr><td><strong>Upstream Name</strong></td><td>Enter a name for your upstream, like <code>example-backend</code>.</td></tr><tr><td><strong>Protocol</strong></td><td>Choose <code>HTTPS</code>.</td></tr><tr><td><strong>Host</strong></td><td>Enter the domain or IP address of your backend server (e.g., <code>tomi-backend.int</code>).</td></tr><tr><td><strong>Port</strong></td><td>Set this to <code>443</code>.</td></tr><tr><td><strong>Weight</strong></td><td>Set it to <code>1</code>.</td></tr><tr><td><strong>Enabled</strong></td><td>Switch this <code>On</code>.</td></tr></tbody></table><p><img loading=lazy src=/images/openresty-12.jpg alt=Screenshoot></p><p><img loading=lazy src=/images/openresty-13.jpg alt=Screenshoot></p><ol start=3><li>After everything is set, click <strong>Save</strong>!</li></ol><p><img loading=lazy src=/images/openresty-14.jpg alt=Screenshoot></p><h2 id=configuring-ssl>Configuring SSL<a hidden class=anchor aria-hidden=true href=#configuring-ssl>#</a></h2><p>Setting up SSL is key to securing your users&rsquo; data. You&rsquo;ll need to work with your DevOps team to get your SSL certificates in place, but here&rsquo;s how you can set things up in the OpenResty Edge dashboard.</p><h3 id=manage-ssl-certificates>Manage SSL Certificates<a hidden class=anchor aria-hidden=true href=#manage-ssl-certificates>#</a></h3><p>In the <strong>SSL</strong> menu, you&rsquo;ll see a table to manage certificates. Here’s what you’ll typically need:</p><ul><li>Your SSL certificate (provided by a Certificate Authority).</li><li>The private key associated with the certificate.</li><li>Your domain, pointing to the correct gateway cluster.</li></ul><p>Make sure all of these details are in order before proceeding.</p><p><img loading=lazy src=/images/openresty-15.jpg alt=Screenshoot></p><p><img loading=lazy src=/images/openresty-16.jpg alt=Screenshoot></p><p><img loading=lazy src=/images/openresty-17.jpg alt=Screenshoot></p><h3 id=check-gateway-clusters>Check Gateway Clusters<a hidden class=anchor aria-hidden=true href=#check-gateway-clusters>#</a></h3><p>Lastly, double-check the <strong>Gateway Clusters</strong> tab. Ensure the IP addresses listed here match the setup for your domain to avoid any connection issues.</p><p><img loading=lazy src=/images/openresty-18.jpg alt=Screenshoot></p><hr><p>You&rsquo;re almost done! Once you&rsquo;re satisfied with all the configurations, click the <strong>Release</strong> button. This will push your changes live, and your app will officially be up and running!</p><p><img loading=lazy src=/images/openresty-19.jpg alt=Screenshoot></p><p>And there you have it! Your new application is now up and running, with all the necessary rules and configurations in place. If you have any questions or run into any issues, don’t hesitate to reach out. Here’s to smooth sailing and successful deployments!</p><p>Feel free to revisit this guide anytime you need a refresher or have new tweaks to make. Happy configuring!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/cybersecurity/>Cybersecurity</a></li><li><a href=http://localhost:1313/tags/openresty/>OpenResty</a></li><li><a href=http://localhost:1313/tags/web-application-firewall/>Web Application Firewall</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/a-collection-of-courses-and-certifications/><span class=title>« Prev</span><br><span>Charting My Cyber Security Path: A Collection of Courses and Certifications</span>
</a><a class=next href=http://localhost:1313/posts/integrating-grafana-slack-and-jira/><span class=title>Next »</span><br><span>Stay Ahead of Issues: How to Connect Grafana Alerts with Slack and Jira Using n8n</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Tomi Mulhartono</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide | Tomi Mulhartono</title>
<meta name=keywords content="cybersecurity,security analysis"><meta name=description content="Have you ever wondered what security analysts actually do? Buckle up, because we&rsquo;re diving into a thrilling investigation of a malware attack! Today&rsquo;s culprit? The notorious Pushdo trojan.
This post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We&rsquo;ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.
So, grab a cup of coffee (or your beverage of choice), and let&rsquo;s embark on this malware takedown adventure!"><meta name=author content="Tomi Mulhartono"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.4599eadb9eb2ad3d0a8d6827b41a8fda8f2f4af226b63466c09c5fddbc8706b7.css integrity="sha256-RZnq256yrT0KjWgntBqP2o8vSvImtjRmwJxf3byHBrc=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/cyberops-associate-v1-0-skills-assessment/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide"><meta property="og:description" content="Have you ever wondered what security analysts actually do? Buckle up, because we&rsquo;re diving into a thrilling investigation of a malware attack! Today&rsquo;s culprit? The notorious Pushdo trojan.
This post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We&rsquo;ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.
So, grab a cup of coffee (or your beverage of choice), and let&rsquo;s embark on this malware takedown adventure!"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/cyberops-associate-v1-0-skills-assessment/"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-30T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-30T00:00:00+00:00"><meta property="og:site_name" content="Tomi Mulhartono"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide"><meta name=twitter:description content="Have you ever wondered what security analysts actually do? Buckle up, because we&rsquo;re diving into a thrilling investigation of a malware attack! Today&rsquo;s culprit? The notorious Pushdo trojan.
This post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We&rsquo;ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.
So, grab a cup of coffee (or your beverage of choice), and let&rsquo;s embark on this malware takedown adventure!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide","item":"http://localhost:1313/posts/cyberops-associate-v1-0-skills-assessment/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide","name":"From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide","description":"Have you ever wondered what security analysts actually do? Buckle up, because we\u0026rsquo;re diving into a thrilling investigation of a malware attack! Today\u0026rsquo;s culprit? The notorious Pushdo trojan.\nThis post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We\u0026rsquo;ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.\nSo, grab a cup of coffee (or your beverage of choice), and let\u0026rsquo;s embark on this malware takedown adventure!","keywords":["cybersecurity","security analysis"],"articleBody":"Have you ever wondered what security analysts actually do? Buckle up, because we’re diving into a thrilling investigation of a malware attack! Today’s culprit? The notorious Pushdo trojan.\nThis post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We’ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.\nSo, grab a cup of coffee (or your beverage of choice), and let’s embark on this malware takedown adventure!\nCyberOps Associates v1.0 - Skills Assessment Introduction You have been hired as a junior security analyst. As part of your training, you were tasked to determine any malicious activity associated with the Pushdo trojan.\nYou will have access to the internet to learn more about the events. You can use websites, such as VirusTotal, to upload and verify threat existence.\nThe tasks below are designed to provide some guidance through the analysis process.\nYou will practice and be assessed on the following skills:\nEvaluate event alerts using Squil and Kibana. Use Google search as a tool to obtain intelligence on a potential exploit. Use VirusTotal to upload and verify threat existence. Content for this assessment was obtained from http://www.malware-traffic-analysis.net/ and is used with permission. We are grateful for the use of this material.\nRequired Resources Host computer with at least 8GB of RAM and 45GB of free disk space Latest version of Oracle VirtualBox Security Onion virtual machine requires 4GB of RAM using 25GB disk space Internet access Instructions Part 1: Gather the Basic Information In this part, you will review the alerts listed in Security Onion VM and gather basic information for the interested time frame.\nStep 1: Verify the status of services a. Log into Security Onion VM using with the username analyst and password cyberops.\nb. Open a terminal window. Enter the sudo so-status command to verify that all the services are ready.\nRight-click on the desktop background and select “Open Terminal”.\nanalyst@SecOnion:~$ sudo so-status Status: securityonion * sguil server [ OK ] Status: seconion-import * pcap_agent (sguil) [ OK ] * snort_agent-1 (sguil) [ OK ] * barnyard2-1 (spooler, unified2 format) [ OK ] Status: Elastic stack * so-elasticsearch [ OK ] * so-logstash [ OK ] * so-kibana [ OK ] * so-freqserver [ OK ] c. When the nsm service is ready, log into Sguil or Kibana with the username analyst and password cyberops.\nOpen Sguil using the shortcut on the desktop. Log in with the username “analyst” and the password “cyberops”. Click “Select All” to select the interfaces, and then click “Start SGUIL”.\nStep 2: Gather basic information. a. Identify time frame of the Pushdo trojan attack, including the date and approximate time.\n2017-06-27 from 13:38:34 to 13:44:32 b. List the alerts noted during this time frame associated with the trojan.\nET CURRENT_EVENTS WinHttpRequest Downloading EXE ET POLICY PE EXE or DLL Windows file download HTTP ET POLICY PE EXE or DLL Windows file download HTTP ET CURRENT_EVENTS Terse alphanumeric executable downloader high likelihood of being hostile ET POLICY PE EXE or DLL Windows file download HTTP ET POLICY External IP Lookup Domain (myip.opendns .com in DNS lookup) ET TROJAN Backdoor.Win32.Pushdo.s Checkin ET TROJAN Pushdo.S CnC response ET POLICY TLS possible TOR SSL traffic c. List the internal IP addresses and external IP addresses involved.\nInternal IP Address: - 192.168.1.96 External IP Addresses: - 143.95.151.192 - 119.28.70.207 - 145.131.10.21 - 62.210.140.158 - 119.28.70.207 - 208.67.222.222 - 208.83.223.34 - 198.1.85.250 Part 2: Learn about the Exploit In this part, you will learn more about the exploit.\nStep 1: Infected host a. Based on the alerts, what is the IP and MAC addresses of the infected computer? Based on the MAC address, what is the vendor of the NIC chipset? (Hint: NetworkMiner or internet search)\nRight-click Alert ID: 5410 and select NetworkMiner\nBased on the alerts, here are the requested details:\nIP: 192.168.1.96 MAC: 00-15-C5-DE-C7-3B NIC Vendor: Dell Inc. b. Based on the alerts, when (date and time in UTC) and how was the PC infected? (Hint: Enter the command date in the terminal to determine the time zone for the displayed time)\nOn NetworkMiner windows, click Files tab to determine date and time in UTC:\nBased on the alerts, here are the requested details:\n2017-06-27 13:38:32 UTC The gerv.gun malware was executed through the Pushdo trojan. How did the malware infect the PC? Use an internet search as necessary.\nThe user on the PC with the IP address 192.168.1.96 inadvertently accessed a malicious website, resulting in the installation of the Pushdo trojan. Pushdo operates as a “downloader” trojan, meaning its main function is to download and install additional malicious software onto the infected system. Upon execution, Pushdo communicates with various control server IP addresses embedded within its code. These servers typically masquerade as Apache web servers and listen on TCP port 80. When specific parameters are present in the HTTP request, Pushdo delivers one or more executable files via HTTP. The type of malware downloaded by Pushdo is determined by the value following the “s-underscore” part of the URL.\nPushdo gathers various information from the victim’s system, including their IP address, administrative privileges status, primary hard drive serial number obtained through SMART_RCV_DRIVE_DATA IO control code, file system type (typically NTFS), the number of times a Pushdo variant has been executed on the system, and the version of Windows operating system retrieved through the GetVersionEx API call.\nStep 2: Examine the exploit. a. Based on the alerts associated with HTTP GET request, what files were downloaded? List the malicious domains observed and the files downloaded.\nRight-click Alert ID: 5410, then select Transcript\nRight-click Alert ID: 5420, then select Transcript\nRight-click Alert ID: 5421, then select Transcript\nBased on the alerts, here are the requested details:\ngerv.gun – matied.com/gerv.gun trow.exe – lounge-haarstudio.nl/oud/trow.exe wp.exe – vantagepointtechnologies.com/wp.exe Use any available tools in Security Onion VM, determine and record the SHA256 hash for the downloaded files that probably infected the computer?\nUtilize the NetworkMiner tool in the following manner: Right-click Alert ID: 5410, choose NetworkMiner, then navigate to the Files tab. Right-click on the first line and select Calculate MD5 / SHA1 / SHA256 hash.\nProvide the SHA256 hash for the files trow.exe and wp.exe corresponding to Alert IDs 5420 and 5421.\nBased on the results, here are the requested details:\ngerv.gun = 0931537889c35226d00ed26962ecacb140521394279eb2ade7e9d2afcf1a7272 trow.exe = 94a0a09ee6a21526ac34d41eabf4ba603e9a30c26e6a1dc072ff45749dfb1fe1 wp.exe = 79d503165d32176842fe386d96c04fb70f6ce1c8a485837957849297e625ea48 b. Navigate to www.virustotal.com input the SHA256 hash to determine if these were detected as malicious files. Record your findings, such as file type and size, other names, and target machine. You can also include any information that is provided by the community posted in VirusTotal.\nOpen the Chromium web browser, navigate to www.virustotal.com, click on “Search” tab and enter the hash.\nBased on the results, here are the requested details:\nFile Name Engines Detected File Type File Size Alternate Names Target Machine gerv.gun 65 Win32 EXE 236.00 KB (241664 bytes) gerv.gun.octet-stream, gerv.gun[11].octet-stream, gerv.gun[12].octet-stream, gerv.gun[8].octet-stream, gerv.gun[6].octet-stream, gerv.gun.exe, (5.410) gerv.gun.octet-stream, gerv.gun, gerv.zip, gerv (1).gun, gerv.gun.bin, img (1), grun.exe, gerv.exe, gerv.gun[1].octet-stream, gerv.gun[2].octet-stream, gerv.gun[5].octet-stream, gerv.gun[9].octet-stream, gerv.gun[3].octet-stream, HTTP-FG0jno3bJLiIzR4hrh.exe, test, tmp523799.697, tmp246975.343, tmp213582.420, extract-1498570714.111294-HTTP-FG0jno3bJLiIzR4hrh.exe, 0931537889c35226d00ed26962ecacb140521394279eb2ade7e9d2afcf1a7272.bin, vector.tui Intel 386 or later processors and compatible processors trow.exe 65 Win32 EXE 323.00 KB (330752 bytes) trow.exe, trow[1].exe, Pedals, Pedals.exe, trow[5].exe, suspect file1, trowexecutablepotential, suspect executables, Suspect Executables, trow, steam 0.0, 0.0 trow.exe, http0, steam5.5, steam 4.4, trow.html, suspect 2, Trow, throw2.exe, taswexuahoft.exe, trow.http, trow1(1).exe, trow(3).exe, MalwareDownload, trow.dat, trow(1).exe, trow[2].exe, HTTP-FfmePA13Dx2LcgCLd.exe, trow.bin, bad, test3, 2017-06-28_18-18-14.exe, bma2beo4.exe Intel 386 or later processors and compatible processors wp.exe 62 Win32 EXE 300.50 KB (307712 bytes) wp.exe, wp[5].exe, binck.exe, wp(1).exe, suspect file 2, wpExecutablepotential1, wp[1].exe, suspect executables 2, wp[2].exe, Suspect Executables1, wp, wp.exe1, wp.exe.bin, trow.exe, suspect 1, wp.http, wp.dat, wp[4].exe, HTTP-FiS6Ty18r3jnk9xajj.exe, malware, test2, wp.bin, wp.exe.x-msdownload, 4da48f6423d5f7d75de281a674c2e620.virobj, test_3 Intel 386 or later processors and compatible processors c. Examine other alerts associated with the infected host during this timeframe and record your findings\nBased on the alerts, here are the requested details:\nET POLICY External IP Lookup Domain (myip.opendns.com in DNS lookup) The infection started when the user of the 192.168.1.96 host performed a DNS lookup through a malicious domain. The destination IP was 208.67.222.222 Step 3: Report Your Findings Summarizes your findings based on the information you have gathered from the previous parts, summarize your findings.\nA host with the IP address 192.168.1.96, which is a PC running Windows, became compromised after accessing a malicious domain through a DNS query. The access to the malicious domain resulted in the infection of the host with the Pushdo trojan. The Pushdo trojan is known for its ability to disguise itself as a legitimate Apache web server by listening on port 80, which makes it more challenging to detect and distinguish from genuine web traffic.\nOnce the Pushdo trojan successfully infiltrated the system, it executed its payload and initiated a series of actions to further compromise the host. The trojan is designed to download and install additional malware onto the infected machine. During the forensic analysis of the compromised PC, three specific malware files were identified: gerv.gun, trow.exe, and wp.exe. These files were discovered to have been downloaded and installed by the Pushdo trojan as part of its post-infection activities.\nTo verify the malicious nature of these files, their SHA-256 hashes were calculated and then checked against the VirusTotal database. VirusTotal is a widely used service that aggregates the detection results of various antivirus engines. The analysis on VirusTotal revealed that these files were indeed recognized as malware by a majority of antivirus sources. The confirmation from VirusTotal established that gerv.gun, trow.exe, and wp.exe were not only suspicious but also verified threats.\nThe infection chain highlights the effectiveness of the Pushdo trojan in not only breaching the system defenses but also in ensuring the persistence of the infection through the installation of additional malware. This incident underscores the importance of robust cybersecurity measures, including regular monitoring of DNS queries, implementation of advanced threat detection systems, and thorough forensic analysis in the event of a security breach.\nThe detailed findings of the investigation can be summarized as follows:\n1. Initial Infection Vector: The host with IP address 192.168.1.96 accessed a malicious domain via a DNS query.\n2. Trojan Identified: The host was infected with the Pushdo trojan, which masquerades as an Apache web server and listens on port 80.\n3. Malware Download and Installation: The Pushdo trojan facilitated the download and installation of three malware files: gerv.gun, trow.exe, and wp.exe.\n4. Verification: The SHA-256 hashes of the malware files were checked on VirusTotal.com, confirming their malicious nature through multiple antivirus detections.\n5. Security Implications: This incident highlights the need for enhanced network security protocols, continuous monitoring for unusual DNS activity, and prompt action upon detection of anomalies to prevent similar infections in the future.\nThis case serves as a stark reminder of the evolving sophistication of cyber threats and the critical need for comprehensive and adaptive cybersecurity strategies\n","wordCount":"1816","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2024-05-30T00:00:00Z","dateModified":"2024-05-30T00:00:00Z","author":{"@type":"Person","name":"Tomi Mulhartono"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/cyberops-associate-v1-0-skills-assessment/"},"publisher":{"@type":"Organization","name":"Tomi Mulhartono","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">From Alerts to Malware: A CyberOps Associates v1.0 Skill Assessment Guide</h1><div class=post-meta><span title='2024-05-30 00:00:00 +0000 +0000'>May 30, 2024</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Tomi Mulhartono</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#required-resources>Required Resources</a></li><li><a href=#instructions>Instructions</a><ul><li><a href=#part-1-gather-the-basic-information>Part 1: Gather the Basic Information</a><ul><li><a href=#step-1-verify-the-status-of-services>Step 1: Verify the status of services</a></li><li><a href=#step-2-gather-basic-information>Step 2: Gather basic information.</a></li></ul></li><li><a href=#part-2-learn-about-the-exploit>Part 2: Learn about the Exploit</a><ul><li><a href=#step-1-infected-host>Step 1: Infected host</a></li><li><a href=#step-2-examine-the-exploit>Step 2: Examine the exploit.</a></li><li><a href=#step-3-report-your-findings>Step 3: Report Your Findings</a></li></ul></li></ul></li></ul></nav></div></details></div><div class=post-content><p>Have you ever wondered what security analysts actually do? Buckle up, because we&rsquo;re diving into a thrilling investigation of a malware attack! Today&rsquo;s culprit? The notorious Pushdo trojan.</p><p>This post will take you through a simulated security assessment, mimicking the thought process and steps involved in uncovering malicious activity. We&rsquo;ll dissect alerts, explore the tools used for analysis, and ultimately expose the tricks employed by Pushdo.</p><p>So, grab a cup of coffee (or your beverage of choice), and let&rsquo;s embark on this malware takedown adventure!</p><h1 id=cyberops-associates-v10---skills-assessment>CyberOps Associates v1.0 - Skills Assessment<a hidden class=anchor aria-hidden=true href=#cyberops-associates-v10---skills-assessment>#</a></h1><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>You have been hired as a junior security analyst. As part of your training, you were tasked to determine any malicious activity associated with the Pushdo trojan.</p><p>You will have access to the internet to learn more about the events. You can use websites, such as VirusTotal, to upload and verify threat existence.</p><p>The tasks below are designed to provide some guidance through the analysis process.</p><p>You will practice and be assessed on the following skills:</p><ul><li>Evaluate event alerts using Squil and Kibana.</li><li>Use Google search as a tool to obtain intelligence on a potential exploit.</li><li>Use VirusTotal to upload and verify threat existence.</li></ul><p>Content for this assessment was obtained from <a href=http://www.malware-traffic-analysis.net/>http://www.malware-traffic-analysis.net/</a> and is used with permission. We are grateful for the use of this material.</p><h2 id=required-resources>Required Resources<a hidden class=anchor aria-hidden=true href=#required-resources>#</a></h2><ul><li>Host computer with at least 8GB of RAM and 45GB of free disk space</li><li>Latest version of Oracle VirtualBox</li><li>Security Onion virtual machine requires 4GB of RAM using 25GB disk space</li><li>Internet access</li></ul><h2 id=instructions>Instructions<a hidden class=anchor aria-hidden=true href=#instructions>#</a></h2><h3 id=part-1-gather-the-basic-information>Part 1: Gather the Basic Information<a hidden class=anchor aria-hidden=true href=#part-1-gather-the-basic-information>#</a></h3><p>In this part, you will review the alerts listed in Security Onion VM and gather basic information for the interested time frame.</p><h4 id=step-1-verify-the-status-of-services>Step 1: Verify the status of services<a hidden class=anchor aria-hidden=true href=#step-1-verify-the-status-of-services>#</a></h4><p>a. Log into Security Onion VM using with the username <strong>analyst</strong> and password <strong>cyberops.</strong></p><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-1.jpg alt=Screenshoot></p><p>b. Open a terminal window. Enter the <code>sudo so-status</code> command to verify that all the services are ready.</p><blockquote><p>Right-click on the desktop background and select &ldquo;<strong>Open Terminal</strong>&rdquo;.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>analyst@SecOnion:~$ sudo so-status
</span></span><span class=line><span class=cl>Status: securityonion
</span></span><span class=line><span class=cl>  * sguil server                                                       <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>Status: seconion-import
</span></span><span class=line><span class=cl>  * pcap_agent <span class=o>(</span>sguil<span class=o>)</span>                                                 <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>  * snort_agent-1 <span class=o>(</span>sguil<span class=o>)</span>                                              <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>  * barnyard2-1 <span class=o>(</span>spooler, unified2 format<span class=o>)</span>                             <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>Status: Elastic stack
</span></span><span class=line><span class=cl>  * so-elasticsearch                                                   <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>  * so-logstash                                                        <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>  * so-kibana                                                          <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>  * so-freqserver                                                      <span class=o>[</span>  OK  <span class=o>]</span></span></span></code></pre></div><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-2.jpg alt=Screenshoot></p><p>c. When the nsm service is ready, log into Sguil or Kibana with the username <strong>analyst</strong> and password <strong>cyberops.</strong></p><blockquote><p>Open <strong>Sguil</strong> using the shortcut on the <strong>desktop</strong>. Log in with the username &ldquo;<strong>analyst</strong>&rdquo; and the password &ldquo;<strong>cyberops</strong>&rdquo;. Click &ldquo;<strong>Select All</strong>&rdquo; to select the interfaces, and then click &ldquo;<strong>Start SGUIL</strong>&rdquo;.</p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-3.jpg alt=Screenshoot></p><h4 id=step-2-gather-basic-information>Step 2: Gather basic information.<a hidden class=anchor aria-hidden=true href=#step-2-gather-basic-information>#</a></h4><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-4.jpg alt=Screenshoot></p><p>a. Identify time frame of the Pushdo trojan attack, including the date and approximate time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>2017-06-27 from 13:38:34 to 13:44:32</span></span></code></pre></div><p>b. List the alerts noted during this time frame associated with the trojan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ET CURRENT_EVENTS WinHttpRequest Downloading EXE
</span></span><span class=line><span class=cl>ET POLICY PE EXE or DLL Windows file download HTTP
</span></span><span class=line><span class=cl>ET POLICY PE EXE or DLL Windows file download HTTP
</span></span><span class=line><span class=cl>ET CURRENT_EVENTS Terse alphanumeric executable downloader high likelihood of being hostile
</span></span><span class=line><span class=cl>ET POLICY PE EXE or DLL Windows file download HTTP
</span></span><span class=line><span class=cl>ET POLICY External IP Lookup Domain <span class=o>(</span>myip.opendns .com in DNS lookup<span class=o>)</span>
</span></span><span class=line><span class=cl>ET TROJAN Backdoor.Win32.Pushdo.s Checkin
</span></span><span class=line><span class=cl>ET TROJAN Pushdo.S CnC response
</span></span><span class=line><span class=cl>ET POLICY TLS possible TOR SSL traffic</span></span></code></pre></div><p>c. List the internal IP addresses and external IP addresses involved.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Internal IP Address:
</span></span><span class=line><span class=cl>- 192.168.1.96
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>External IP Addresses:
</span></span><span class=line><span class=cl>- 143.95.151.192
</span></span><span class=line><span class=cl>- 119.28.70.207
</span></span><span class=line><span class=cl>- 145.131.10.21
</span></span><span class=line><span class=cl>- 62.210.140.158
</span></span><span class=line><span class=cl>- 119.28.70.207
</span></span><span class=line><span class=cl>- 208.67.222.222
</span></span><span class=line><span class=cl>- 208.83.223.34
</span></span><span class=line><span class=cl>- 198.1.85.250</span></span></code></pre></div><h3 id=part-2-learn-about-the-exploit>Part 2: Learn about the Exploit<a hidden class=anchor aria-hidden=true href=#part-2-learn-about-the-exploit>#</a></h3><p>In this part, you will learn more about the exploit.</p><h4 id=step-1-infected-host>Step 1: Infected host<a hidden class=anchor aria-hidden=true href=#step-1-infected-host>#</a></h4><p>a. Based on the alerts, what is the IP and MAC addresses of the infected computer? Based on the MAC address, what is the vendor of the NIC chipset? (Hint: NetworkMiner or internet search)</p><blockquote><p>Right-click <strong>Alert ID: 5410</strong> and select <strong>NetworkMiner</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-5.jpg alt=Screenshoot>
<img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-6.jpg alt=Screenshoot></p><p>Based on the alerts, here are the requested details:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>IP: 192.168.1.96
</span></span><span class=line><span class=cl>MAC: 00-15-C5-DE-C7-3B
</span></span><span class=line><span class=cl>NIC Vendor: Dell Inc.</span></span></code></pre></div><p>b. Based on the alerts, when (date and time in UTC) and how was the PC infected? (Hint: Enter the command date in the terminal to determine the time zone for the displayed time)</p><blockquote><p>On <strong>NetworkMiner</strong> windows, click <strong>Files</strong> tab to determine date and time in UTC:</p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-7.jpg alt=Screenshoot></p><p>Based on the alerts, here are the requested details:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>2017-06-27 13:38:32 UTC
</span></span><span class=line><span class=cl>The gerv.gun malware was executed through the Pushdo trojan.</span></span></code></pre></div><p><strong>How did the malware infect the PC? Use an internet search as necessary.</strong></p><p>The user on the PC with the IP address <strong>192.168.1.96</strong> inadvertently accessed a malicious website,
resulting in the installation of the Pushdo trojan. Pushdo operates as a &ldquo;downloader&rdquo; trojan, meaning its
main function is to download and install additional malicious software onto the infected system. Upon
execution, Pushdo communicates with various control server IP addresses embedded within its code.
These servers typically masquerade as Apache web servers and listen on TCP port 80. When specific
parameters are present in the HTTP request, Pushdo delivers one or more executable files via HTTP.
The type of malware downloaded by Pushdo is determined by the value following the &ldquo;s-underscore&rdquo; part
of the URL.</p><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-8.jpg alt=Screenshoot></p><p>Pushdo gathers various information from the victim&rsquo;s system, including their IP address, administrative
privileges status, primary hard drive serial number obtained through SMART_RCV_DRIVE_DATA IO
control code, file system type (typically NTFS), the number of times a Pushdo variant has been executed
on the system, and the version of Windows operating system retrieved through the GetVersionEx API
call.</p><h4 id=step-2-examine-the-exploit>Step 2: Examine the exploit.<a hidden class=anchor aria-hidden=true href=#step-2-examine-the-exploit>#</a></h4><p>a. Based on the alerts associated with HTTP GET request, what files were downloaded? List the malicious domains observed and the files downloaded.</p><blockquote><p>Right-click Alert ID: 5410, then select <strong>Transcript</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-9.jpg alt=Screenshoot></p><blockquote><p>Right-click <strong>Alert ID: 5420</strong>, then select <strong>Transcript</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-10.jpg alt=Screenshoot></p><blockquote><p>Right-click <strong>Alert ID: 5421</strong>, then select <strong>Transcript</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-11.jpg alt=Screenshoot></p><p>Based on the alerts, here are the requested details:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gerv.gun – matied.com/gerv.gun
</span></span><span class=line><span class=cl>trow.exe – lounge-haarstudio.nl/oud/trow.exe
</span></span><span class=line><span class=cl>wp.exe – vantagepointtechnologies.com/wp.exe</span></span></code></pre></div><p><strong>Use any available tools in Security Onion VM, determine and record the SHA256 hash for the downloaded files that probably infected the computer?</strong></p><blockquote><p>Utilize the <strong>NetworkMiner</strong> tool in the following manner: Right-click <strong>Alert ID: 5410</strong>, choose <strong>NetworkMiner</strong>, then navigate to the <strong>Files</strong> tab. Right-click on the first line and select <strong>Calculate MD5 / SHA1 / SHA256 hash.</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-12.jpg alt=Screenshoot></p><blockquote><p>Provide the <strong>SHA256</strong> hash for the files <strong>trow.exe</strong> and <strong>wp.exe</strong> corresponding to <strong>Alert IDs 5420 and 5421.</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-13.jpg alt=Screenshoot></p><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-14.jpg alt=Screenshoot></p><p>Based on the results, here are the requested details:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gerv.gun <span class=o>=</span> 0931537889c35226d00ed26962ecacb140521394279eb2ade7e9d2afcf1a7272
</span></span><span class=line><span class=cl>trow.exe <span class=o>=</span> 94a0a09ee6a21526ac34d41eabf4ba603e9a30c26e6a1dc072ff45749dfb1fe1
</span></span><span class=line><span class=cl>wp.exe <span class=o>=</span> 79d503165d32176842fe386d96c04fb70f6ce1c8a485837957849297e625ea48</span></span></code></pre></div><p>b. Navigate to <a href=https://www.virustotal.com>www.virustotal.com</a> input the SHA256 hash to determine if these were detected as malicious files. Record your findings, such as file type and size, other names, and target machine. You can also include any information that is provided by the community posted in VirusTotal.</p><blockquote><p>Open the Chromium web browser, navigate to <a href=https://www.virustotal.com>www.virustotal.com</a>, click on &ldquo;<strong>Search</strong>&rdquo; tab and enter the <strong>hash.</strong></p></blockquote><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-15.jpg alt=Screenshoot>
<img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-16.jpg alt=Screenshoot>
<img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-17.jpg alt=Screenshoot>
<img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-18.jpg alt=Screenshoot></p><p>Based on the results, here are the requested details:</p><table><thead><tr><th>File Name</th><th>Engines Detected</th><th>File Type</th><th>File Size</th><th>Alternate Names</th><th>Target Machine</th></tr></thead><tbody><tr><td>gerv.gun</td><td>65</td><td>Win32 EXE</td><td>236.00 KB (241664 bytes)</td><td>gerv.gun.octet-stream, gerv.gun[11].octet-stream, gerv.gun[12].octet-stream, gerv.gun[8].octet-stream, gerv.gun[6].octet-stream, gerv.gun.exe, (5.410) gerv.gun.octet-stream, gerv.gun, gerv.zip, gerv (1).gun, gerv.gun.bin, img (1), grun.exe, gerv.exe, gerv.gun[1].octet-stream, gerv.gun[2].octet-stream, gerv.gun[5].octet-stream, gerv.gun[9].octet-stream, gerv.gun[3].octet-stream, HTTP-FG0jno3bJLiIzR4hrh.exe, test, tmp523799.697, tmp246975.343, tmp213582.420, extract-1498570714.111294-HTTP-FG0jno3bJLiIzR4hrh.exe, 0931537889c35226d00ed26962ecacb140521394279eb2ade7e9d2afcf1a7272.bin, vector.tui</td><td>Intel 386 or later processors and compatible processors</td></tr><tr><td>trow.exe</td><td>65</td><td>Win32 EXE</td><td>323.00 KB (330752 bytes)</td><td>trow.exe, trow[1].exe, Pedals, Pedals.exe, trow[5].exe, suspect file1, trowexecutablepotential, suspect executables, Suspect Executables, trow, steam 0.0, 0.0 trow.exe, http0, steam5.5, steam 4.4, trow.html, suspect 2, Trow, throw2.exe, taswexuahoft.exe, trow.http, trow1(1).exe, trow(3).exe, MalwareDownload, trow.dat, trow(1).exe, trow[2].exe, HTTP-FfmePA13Dx2LcgCLd.exe, trow.bin, bad, test3, 2017-06-28_18-18-14.exe, bma2beo4.exe</td><td>Intel 386 or later processors and compatible processors</td></tr><tr><td>wp.exe</td><td>62</td><td>Win32 EXE</td><td>300.50 KB (307712 bytes)</td><td>wp.exe, wp[5].exe, binck.exe, wp(1).exe, suspect file 2, wpExecutablepotential1, wp[1].exe, suspect executables 2, wp[2].exe, Suspect Executables1, wp, wp.exe1, wp.exe.bin, trow.exe, suspect 1, wp.http, wp.dat, wp[4].exe, HTTP-FiS6Ty18r3jnk9xajj.exe, malware, test2, wp.bin, wp.exe.x-msdownload, 4da48f6423d5f7d75de281a674c2e620.virobj, test_3</td><td>Intel 386 or later processors and compatible processors</td></tr></tbody></table><p>c. Examine other alerts associated with the infected host during this timeframe and record your findings</p><p><img loading=lazy src=/images/cyberops-associate-v1-0-skills-assessment-19.jpg alt=Screenshoot></p><p>Based on the alerts, here are the requested details:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ET POLICY External IP Lookup Domain <span class=o>(</span>myip.opendns.com in DNS lookup<span class=o>)</span>
</span></span><span class=line><span class=cl>The infection started when the user of the 192.168.1.96 host performed a DNS lookup through a malicious domain.
</span></span><span class=line><span class=cl>The destination IP was 208.67.222.222</span></span></code></pre></div><h4 id=step-3-report-your-findings>Step 3: Report Your Findings<a hidden class=anchor aria-hidden=true href=#step-3-report-your-findings>#</a></h4><p>Summarizes your findings based on the information you have gathered from the previous parts, summarize your findings.</p><p>A host with the IP address 192.168.1.96, which is a PC running Windows, became compromised after accessing a malicious domain through a DNS query. The access to the malicious domain resulted in the infection of the host with the Pushdo trojan. The Pushdo trojan is known for its ability to disguise itself as a legitimate Apache web server by listening on port 80, which makes it more challenging to detect and distinguish from genuine web traffic.</p><p>Once the Pushdo trojan successfully infiltrated the system, it executed its payload and initiated a series of
actions to further compromise the host. The trojan is designed to download and install additional malware
onto the infected machine. During the forensic analysis of the compromised PC, three specific malware files
were identified: gerv.gun, trow.exe, and wp.exe. These files were discovered to have been downloaded and
installed by the Pushdo trojan as part of its post-infection activities.</p><p>To verify the malicious nature of these files, their SHA-256 hashes were calculated and then checked against
the VirusTotal database. VirusTotal is a widely used service that aggregates the detection results of various
antivirus engines. The analysis on VirusTotal revealed that these files were indeed recognized as malware by
a majority of antivirus sources. The confirmation from VirusTotal established that gerv.gun, trow.exe, and
wp.exe were not only suspicious but also verified threats.</p><p>The infection chain highlights the effectiveness of the Pushdo trojan in not only breaching the system
defenses but also in ensuring the persistence of the infection through the installation of additional malware.
This incident underscores the importance of robust cybersecurity measures, including regular monitoring of
DNS queries, implementation of advanced threat detection systems, and thorough forensic analysis in the
event of a security breach.</p><p>The detailed findings of the investigation can be summarized as follows:</p><p><strong>1. Initial Infection Vector:</strong> The host with IP address 192.168.1.96 accessed a malicious domain via a DNS query.</p><p><strong>2. Trojan Identified:</strong> The host was infected with the Pushdo trojan, which masquerades as an Apache web server and listens on port 80.</p><p><strong>3. Malware Download and Installation:</strong> The Pushdo trojan facilitated the download and installation of three malware files: gerv.gun, trow.exe, and wp.exe.</p><p><strong>4. Verification:</strong> The SHA-256 hashes of the malware files were checked on VirusTotal.com, confirming their
malicious nature through multiple antivirus detections.</p><p><strong>5. Security Implications:</strong> This incident highlights the need for enhanced network security protocols, continuous monitoring for unusual DNS activity, and prompt action upon detection of anomalies to prevent similar infections in the future.</p><p>This case serves as a stark reminder of the evolving sophistication of cyber threats and the critical need for
comprehensive and adaptive cybersecurity strategies</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/cybersecurity/>Cybersecurity</a></li><li><a href=http://localhost:1313/tags/security-analysis/>Security Analysis</a></li></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/cyber-threat-management/><span class=title>Next »</span><br><span>Cybersecurity Warrior: Embarking on a Journey with Cisco's Cyber Threat Management Course</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Tomi Mulhartono</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>